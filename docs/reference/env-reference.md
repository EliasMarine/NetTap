# Environment Variable Reference

Complete reference for all environment variables used by NetTap. Set these in `/opt/nettap/.env`.

---

## Network Interfaces

| Variable | Default | Description |
|---|---|---|
| `WAN_INTERFACE` | `eth0` | Network interface connected to the ISP modem |
| `LAN_INTERFACE` | `eth1` | Network interface connected to the router |
| `MGMT_INTERFACE` | (none) | Management interface for dashboard access |
| `MGMT_IP` | (none) | Static IP address for the management interface |
| `MGMT_NETMASK` | `255.255.255.0` | Netmask for the management interface |

---

## Dashboard

| Variable | Default | Description |
|---|---|---|
| `NETTAP_HOSTNAME` | `nettap.local` | mDNS hostname for the appliance |
| `DASHBOARD_PORT` | `443` | HTTPS port for the NetTap dashboard |

---

## OpenSearch

| Variable | Default | Description |
|---|---|---|
| `OPENSEARCH_JAVA_OPTS` | `-Xms4g -Xmx4g` | JVM heap size for OpenSearch. Set `-Xms` and `-Xmx` to the same value. |
| `OPENSEARCH_ADMIN_PASSWORD` | `N3tT@p_0p3n` | Initial admin password for OpenSearch. Auto-generated by `generate-secrets.sh`. |
| `OPENSEARCH_URL` | `https://opensearch:9200` | Internal OpenSearch URL (used by containers). |

---

## Storage Retention

| Variable | Default | Description |
|---|---|---|
| `RETENTION_HOT` | `90` | Days to retain Zeek metadata logs (hot tier) |
| `RETENTION_WARM` | `180` | Days to retain Suricata alert data (warm tier) |
| `RETENTION_COLD` | `30` | Days to retain raw PCAP captures (cold tier) |
| `DISK_THRESHOLD_PERCENT` | `80` | Start pruning old data when disk usage exceeds this percentage |
| `EMERGENCY_THRESHOLD_PERCENT` | `90` | Aggressive pruning threshold |

---

## Daemon

| Variable | Default | Description |
|---|---|---|
| `API_PORT` | `8880` | Port for the daemon's HTTP API server |
| `STORAGE_CHECK_INTERVAL` | `300` | Seconds between storage maintenance cycles |
| `SMART_CHECK_INTERVAL` | `3600` | Seconds between SMART health checks |
| `SMART_DEVICE` | `/dev/nvme0n1` | Block device to monitor for SMART health |
| `LOG_LEVEL` | `INFO` | Daemon log level: `DEBUG`, `INFO`, `WARNING`, `ERROR` |

---

## Alerting / Notifications

| Variable | Default | Description |
|---|---|---|
| `SMTP_HOST` | (none) | SMTP server address for email notifications |
| `SMTP_PORT` | `587` | SMTP port |
| `SMTP_USER` | (none) | SMTP authentication username |
| `SMTP_PASS` | (none) | SMTP authentication password |
| `ALERT_EMAIL` | (none) | Email address to receive alert notifications |
| `WEBHOOK_URL` | (none) | Webhook URL for alert notifications (Slack, Discord, etc.) |

---

## Malcolm Stack

| Variable | Default | Description |
|---|---|---|
| `MALCOLM_IMAGE_REGISTRY` | `ghcr.io/idaholab/malcolm` | Docker registry for Malcolm images |
| `MALCOLM_IMAGE_TAG` | `26.02.0` | Malcolm container image tag |
| `MALCOLM_HTTPS_PORT` | `9443` | HTTPS port for Malcolm dashboards |
| `MALCOLM_CERTS_DIR` | `./certs` | Directory containing Malcolm TLS certificates |
| `MALCOLM_AUTH_DIR` | `./auth` | Directory containing Malcolm authentication files |

---

## Capture

| Variable | Default | Description |
|---|---|---|
| `PCAP_IFACE` | `br0` | Network interface for packet capture |
| `PCAP_ROTATE_MB` | `4096` | Rotate PCAP files at this size (MB) |
| `PCAP_ROTATE_MIN` | `10` | Rotate PCAP files at this interval (minutes) |
| `PCAP_DIR` | `/opt/nettap/pcap` | Directory for PCAP file storage |
| `ZEEK_LOCAL_NETS` | `192.168.0.0/16,10.0.0.0/8,172.16.0.0/12` | RFC 1918 local network definitions for Zeek |

---

## Logstash

| Variable | Default | Description |
|---|---|---|
| `LS_JAVA_OPTS` | `-Xmx2g -Xms2g` | JVM heap size for Logstash |
| `LOGSTASH_WORKERS` | `2` | Number of Logstash pipeline workers |

---

## Arkime

| Variable | Default | Description |
|---|---|---|
| `ARKIME_PACKET_THREADS` | `2` | Number of Arkime packet processing threads |
| `ARKIME_SECRET` | `NetTap_Arkime_Secret` | Arkime password encryption secret. Auto-generated by `generate-secrets.sh`. |

---

## Redis

| Variable | Default | Description |
|---|---|---|
| `REDIS_PASSWORD` | `NetTap_Redis_Secret` | Redis authentication password. Auto-generated by `generate-secrets.sh`. |

---

## Grafana

| Variable | Default | Description |
|---|---|---|
| `GRAFANA_ADMIN_PASSWORD` | `nettap` | Grafana admin password. Auto-generated by `generate-secrets.sh`. |

---

## Nginx

| Variable | Default | Description |
|---|---|---|
| `NGINX_AUTH_MODE` | `basic` | Malcolm nginx authentication mode |

---

## Process Identity

| Variable | Default | Description |
|---|---|---|
| `PUID` | `1000` | User ID for container processes |
| `PGID` | `1000` | Group ID for container processes |

---

## Bridge Health Monitoring

| Variable | Default | Description |
|---|---|---|
| `BRIDGE_NAME` | `br0` | Name of the network bridge |
| `WAN_IFACE` | `eth0` | WAN-side interface in the bridge |
| `LAN_IFACE` | `eth1` | LAN-side interface in the bridge |

---

## Software Updates

| Variable | Default | Description |
|---|---|---|
| `COMPOSE_FILE` | `/opt/nettap/docker/docker-compose.yml` | Path to Docker Compose file |
| `BACKUP_DIR` | `/opt/nettap/backups` | Directory for update backups |
| `GITHUB_REPO` | `EliasMarine/NetTap` | GitHub repository for update checks |

---

## Data Paths

| Variable | Default | Description |
|---|---|---|
| `GEOIP_DB_PATH` | `/opt/nettap/data/GeoLite2-City.mmdb` | Path to MaxMind GeoIP database |
| `DEVICE_BASELINE_FILE` | `/opt/nettap/data/device_baseline.json` | Device baseline storage file |
| `INVESTIGATIONS_FILE` | `/opt/nettap/data/investigations.json` | Investigation bookmarks storage |
| `DETECTION_PACKS_DIR` | `/opt/nettap/data/detection-packs` | Directory for community detection packs |
| `REPORTS_DIR` | `/opt/nettap/data/reports` | Directory for generated reports |
| `REPORT_SCHEDULES_FILE` | `/opt/nettap/data/report_schedules.json` | Report schedule configuration |
| `NETTAP_ENV_FILE` | `/opt/nettap/.env` | Path to the main environment file |

---

## Example `.env` File

```ini title=".env"
# NetTap Environment Configuration

# Network interfaces
WAN_INTERFACE=eth0
LAN_INTERFACE=eth1
MGMT_INTERFACE=eth2
MGMT_IP=192.168.1.100
MGMT_NETMASK=255.255.255.0

# Dashboard
NETTAP_HOSTNAME=nettap.local
DASHBOARD_PORT=443

# OpenSearch
OPENSEARCH_JAVA_OPTS="-Xms4g -Xmx4g"

# Storage retention (days)
RETENTION_HOT=90
RETENTION_WARM=180
RETENTION_COLD=30
DISK_THRESHOLD_PERCENT=80

# Alerting (optional)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
ALERT_EMAIL=

WEBHOOK_URL=
```
