# NetTap Suricata overrides
# Merged with Malcolm's default suricata.yaml

# Capture interface — the bridge
af-packet:
  - interface: br0
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: yes
    use-mmap: yes
    ring-size: 200000

# Emerging Threats Open ruleset (pre-loaded)
default-rule-path: /var/lib/suricata/rules
rule-files:
  - suricata.rules

# Output to Eve JSON for OpenSearch ingestion
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: eve.json
      # ---------------------------------------------------------------
      # Log rotation and compression
      # ---------------------------------------------------------------
      # Suricata writes uncompressed eve.json logs to disk.
      # Actual zstd compression (~6:1 for Suricata alert JSON) is handled
      # by Malcolm's filebeat/logstash pipeline, which picks up rotated
      # logs and applies zstd compression before shipping to OpenSearch.
      #
      # This keeps Suricata's capture path CPU-efficient — compression
      # happens asynchronously in the log shipping pipeline rather than
      # on the real-time packet processing thread.
      # ---------------------------------------------------------------
      rotate-interval: day
      types:
        - alert
        - dns
        - tls
        - http
        - files
        - flow
